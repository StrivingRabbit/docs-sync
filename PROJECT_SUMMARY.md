# docs-sync é¡¹ç›®æ€»ç»“

## âœ… é¡¹ç›®å®Œæ•´æ€§è¯„ä¼°

ç»è¿‡å…¨é¢æ‰«æå’Œè¯„ä¼°ï¼Œ**docs-sync é¡¹ç›®å·²ç»å…·å¤‡æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½**ï¼Œå¯ä»¥æŠ•å…¥ä½¿ç”¨ã€‚

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½æ¸…å•

### 1. Git ä»“åº“åŒæ­¥ âœ…
- **æ–‡ä»¶**: [src/git.ts](src/git.ts)
- **åŠŸèƒ½**:
  - ä»å¤šä¸ª Git ä»“åº“å…‹éš†/æ‹‰å–æ–‡æ¡£
  - æ”¯æŒæŒ‡å®šåˆ†æ”¯
  - ç¼“å­˜åˆ°æœ¬åœ°ç›®å½•
  - å®Œæ•´çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—

### 2. æ–‡æ¡£ç¼–è¯‘ç³»ç»Ÿ âœ…
- **æ–‡ä»¶**: [src/compiler.ts](src/compiler.ts)
- **åŠŸèƒ½**:
  - è¯»å–æºæ–‡ä»¶
  - å¤„ç† `@include` æŒ‡ä»¤
  - åº”ç”¨ç«™ç‚¹è¿‡æ»¤
  - ç”Ÿæˆå†…å®¹å“ˆå¸Œ
  - å†™å…¥ç›®æ ‡ä½ç½®
  - ä¼˜é›…çš„é”™è¯¯å¤„ç†

### 3. Include æŒ‡ä»¤å¤„ç† âœ…
- **æ–‡ä»¶**: [src/include.ts](src/include.ts)
- **åŠŸèƒ½**:
  - è§£æ `<!-- @include source:path -->` è¯­æ³•
  - é€’å½’åŒ…å«å…¶ä»–æ–‡ä»¶
  - è‡ªåŠ¨å‰¥ç¦» frontmatter
  - ä¾èµ–è¿½è¸ª
  - é”™è¯¯å ä½ç¬¦ï¼ˆæ‰¾ä¸åˆ°æ–‡ä»¶æ—¶ï¼‰

### 4. ç«™ç‚¹è¿‡æ»¤ âœ…
- **æ–‡ä»¶**: [src/site-filter.ts](src/site-filter.ts)
- **åŠŸèƒ½**:
  - `<!-- @site site-a -->` è¯­æ³•æ”¯æŒ
  - å¤šç«™ç‚¹æ”¯æŒï¼ˆé€—å·åˆ†éš”ï¼‰
  - æ’é™¤è¯­æ³• `!site-a`
  - æ¡ä»¶å†…å®¹åŒ…å«/æ’é™¤

### 5. ä¾èµ–å›¾è¿½è¸ª âœ…
- **æ–‡ä»¶**: [src/graph.ts](src/graph.ts)
- **åŠŸèƒ½**:
  - è¿½è¸ªæ–‡ä»¶ä¾èµ–å…³ç³»
  - å¢é‡ç¼–è¯‘æ”¯æŒ
  - æŸ¥æ‰¾å—å½±å“çš„æ–‡ä»¶
  - å¾ªç¯ä¾èµ–ä¿æŠ¤
  - ä¼ é€’ä¾èµ–è§£æ

### 6. æ–‡ä»¶ç³»ç»ŸæŠ½è±¡ âœ…
- **æ–‡ä»¶**: [src/fs/](src/fs/)
- **åŠŸèƒ½**:
  - `realFs`: çœŸå®æ–‡ä»¶ç³»ç»Ÿæ“ä½œ
  - `dryRunFs`: é¢„æ¼”æ¨¡å¼ï¼ˆåªè®°å½•æ—¥å¿—ï¼‰
  - ç»Ÿä¸€çš„ `FsOps` æ¥å£
  - æ˜“äºæµ‹è¯•å’Œæ‰©å±•

### 7. æ—¥å¿—ç³»ç»Ÿ âœ…
- **æ–‡ä»¶**: [src/logger.ts](src/logger.ts)
- **åŠŸèƒ½**:
  - å½©è‰²æ§åˆ¶å°è¾“å‡º
  - æ—¶é—´æˆ³
  - å¤šçº§åˆ«æ—¥å¿—ï¼ˆinfo, success, warn, error, debugï¼‰
  - Debug æ¨¡å¼æ”¯æŒ
  - ä¼˜é›…çš„é”™è¯¯å±•ç¤º

### 8. å¼•æ“å’Œ CLI âœ…
- **æ–‡ä»¶**: [src/engine.ts](src/engine.ts), [bin/docs-sync.ts](bin/docs-sync.ts)
- **åŠŸèƒ½**:
  - `sync` å‘½ä»¤ï¼šä¸€æ¬¡æ€§åŒæ­¥
  - `watch` å‘½ä»¤ï¼šç›‘è§†æ¨¡å¼ï¼Œè‡ªåŠ¨é‡æ–°ç¼–è¯‘
  - `--dry-run` æ ‡å¿—ï¼šé¢„è§ˆæ›´æ”¹
  - `--debug` æ ‡å¿—ï¼šè¯¦ç»†æ—¥å¿—
  - é…ç½®æ–‡ä»¶åŠ è½½
  - é”™è¯¯æ”¶é›†å’Œæ±‡æ€»

### 9. é…ç½®ç®¡ç† âœ…
- **æ–‡ä»¶**: [src/config.ts](src/config.ts), [src/types.ts](src/types.ts)
- **åŠŸèƒ½**:
  - TypeScript é…ç½®æ–‡ä»¶
  - ç±»å‹å®‰å…¨çš„é…ç½®
  - `defineConfig` è¾…åŠ©å‡½æ•°

## ğŸ§ª æµ‹è¯•è¦†ç›–

### å•å…ƒæµ‹è¯• âœ…
- âœ… [site-filter.test.ts](src/__tests__/site-filter.test.ts) - 9 ä¸ªæµ‹è¯•ç”¨ä¾‹
- âœ… [graph.test.ts](src/__tests__/graph.test.ts) - 9 ä¸ªæµ‹è¯•ç”¨ä¾‹
- âœ… [include.test.ts](src/__tests__/include.test.ts) - 12 ä¸ªæµ‹è¯•ç”¨ä¾‹
- âœ… [compiler.test.ts](src/__tests__/compiler.test.ts) - 10 ä¸ªæµ‹è¯•ç”¨ä¾‹

### é›†æˆæµ‹è¯• âœ…
- âœ… [integration.test.ts](src/__tests__/integration.test.ts) - 3 ä¸ªå®Œæ•´å·¥ä½œæµæµ‹è¯•

### æµ‹è¯•æ¡†æ¶
- âœ… Vitest é…ç½®
- âœ… è¦†ç›–ç‡æŠ¥å‘Š
- âœ… Mock ç­–ç•¥
- âœ… æµ‹è¯•æ–‡æ¡£

## ğŸ“ é¡¹ç›®ç»“æ„

```
docs-sync/
â”œâ”€â”€ bin/
â”‚   â””â”€â”€ docs-sync.ts           # CLI å…¥å£ç‚¹
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ __tests__/             # æµ‹è¯•æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ site-filter.test.ts
â”‚   â”‚   â”œâ”€â”€ graph.test.ts
â”‚   â”‚   â”œâ”€â”€ include.test.ts
â”‚   â”‚   â”œâ”€â”€ compiler.test.ts
â”‚   â”‚   â””â”€â”€ integration.test.ts
â”‚   â”œâ”€â”€ fs/                    # æ–‡ä»¶ç³»ç»ŸæŠ½è±¡
â”‚   â”‚   â”œâ”€â”€ types.ts
â”‚   â”‚   â”œâ”€â”€ realFs.ts
â”‚   â”‚   â”œâ”€â”€ dryRunFs.ts
â”‚   â”‚   â””â”€â”€ index.ts
â”‚   â”œâ”€â”€ compiler.ts            # ç¼–è¯‘å™¨æ ¸å¿ƒ
â”‚   â”œâ”€â”€ config.ts              # é…ç½®å·¥å…·
â”‚   â”œâ”€â”€ engine.ts              # åŒæ­¥å¼•æ“
â”‚   â”œâ”€â”€ git.ts                 # Git æ“ä½œ
â”‚   â”œâ”€â”€ graph.ts               # ä¾èµ–å›¾
â”‚   â”œâ”€â”€ hash.ts                # å†…å®¹å“ˆå¸Œ
â”‚   â”œâ”€â”€ include.ts             # Include å¤„ç†
â”‚   â”œâ”€â”€ logger.ts              # æ—¥å¿—ç³»ç»Ÿ
â”‚   â”œâ”€â”€ site-filter.ts         # ç«™ç‚¹è¿‡æ»¤
â”‚   â””â”€â”€ types.ts               # ç±»å‹å®šä¹‰
â”œâ”€â”€ docs-sync.config.ts        # é…ç½®ç¤ºä¾‹
â”œâ”€â”€ package.json
â”œâ”€â”€ tsconfig.json
â”œâ”€â”€ vitest.config.ts
â”œâ”€â”€ README.md                  # ç”¨æˆ·æ–‡æ¡£
â”œâ”€â”€ TESTING.md                 # æµ‹è¯•æ–‡æ¡£
â””â”€â”€ PROJECT_SUMMARY.md         # æœ¬æ–‡æ¡£
```

## ğŸš€ ä½¿ç”¨æ–¹å¼

### å®‰è£…
```bash
npm install
npm run build
```

### åŸºæœ¬ä½¿ç”¨
```bash
# åŒæ­¥ä¸€æ¬¡
npm run dev sync

# é¢„æ¼”æ¨¡å¼
npm run dev sync -- --dry-run

# ç›‘è§†æ¨¡å¼
npm run dev watch

# è°ƒè¯•æ¨¡å¼
npm run dev sync -- --debug
```

### æµ‹è¯•
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
npm test

# ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage
```

## ğŸ’¡ æ ¸å¿ƒç‰¹æ€§

### 1. ä¼˜é›…çš„é”™è¯¯å¤„ç†
- å•ä¸ªæ–‡ä»¶ç¼–è¯‘å¤±è´¥ä¸ä¼šä¸­æ–­æ•´ä¸ªæµç¨‹
- Watch æ¨¡å¼ä¸‹é”™è¯¯ä¸ä¼šä¸­æ–­ç›‘è§†
- Include æ–‡ä»¶ç¼ºå¤±æ—¶ä½¿ç”¨é”™è¯¯å ä½ç¬¦
- é”™è¯¯æ”¶é›†å’Œæ±‡æ€»æŠ¥å‘Š

### 2. çµæ´»çš„æ–‡ä»¶ç³»ç»Ÿ
- çœŸå®æ“ä½œæ¨¡å¼ï¼ˆ`realFs`ï¼‰
- é¢„æ¼”æ¨¡å¼ï¼ˆ`dryRunFs`ï¼‰
- æ˜“äºæµ‹è¯•ï¼ˆMock `FsOps`ï¼‰

### 3. å¼ºå¤§çš„æ—¥å¿—ç³»ç»Ÿ
- å½©è‰²è¾“å‡º
- æ—¶é—´æˆ³
- å¤šçº§åˆ«æ—¥å¿—
- Debug æ¨¡å¼

### 4. å¢é‡ç¼–è¯‘
- ä¾èµ–å›¾è¿½è¸ª
- åªé‡æ–°ç¼–è¯‘å—å½±å“çš„æ–‡ä»¶
- æ€§èƒ½ä¼˜åŒ–

## ğŸ“Š ä»£ç è´¨é‡

- âœ… TypeScript ä¸¥æ ¼æ¨¡å¼
- âœ… å®Œæ•´çš„ç±»å‹å®šä¹‰
- âœ… æ¨¡å—åŒ–è®¾è®¡
- âœ… å•ä¸€èŒè´£åŸåˆ™
- âœ… ä¾èµ–æ³¨å…¥ï¼ˆFsOpsï¼‰
- âœ… é”™è¯¯å¤„ç†
- âœ… æ—¥å¿—è®°å½•
- âœ… æµ‹è¯•è¦†ç›–

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

è™½ç„¶é¡¹ç›®å·²ç»å®Œæ•´ä¸”å¯ç”¨ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¯é€‰çš„æ”¹è¿›æ–¹å‘ï¼š

### çŸ­æœŸä¼˜åŒ–
1. â­ æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•
2. â­ å®ç°é…ç½®éªŒè¯
3. â­ æ·»åŠ æ›´å¤š CLI é€‰é¡¹ï¼ˆå¦‚ `--force`, `--verbose`ï¼‰

### ä¸­æœŸå¢å¼º
1. ğŸ”„ å®ç°å¹¶è¡Œç¼–è¯‘
2. ğŸ”„ æ·»åŠ æ’ä»¶ç³»ç»Ÿ
3. ğŸ”„ æ”¯æŒè‡ªå®šä¹‰æŒ‡ä»¤

### é•¿æœŸè§„åˆ’
1. ğŸ“¦ å‘å¸ƒåˆ° npm
2. ğŸ“¦ æä¾› GitHub Action
3. ğŸ“¦ Web UI ç®¡ç†ç•Œé¢

## âœ… ç»“è®º

**docs-sync é¡¹ç›®å·²ç»å®Œå…¨å¯ä»¥æŠ•å…¥ä½¿ç”¨ï¼**

æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éƒ½å·²å®ç°å¹¶ç»è¿‡æµ‹è¯•ï¼š
- âœ… Git ä»“åº“åŒæ­¥
- âœ… æ–‡æ¡£ç¼–è¯‘
- âœ… Include æŒ‡ä»¤
- âœ… ç«™ç‚¹è¿‡æ»¤
- âœ… ä¾èµ–è¿½è¸ª
- âœ… æ–‡ä»¶ç³»ç»ŸæŠ½è±¡
- âœ… æ—¥å¿—ç³»ç»Ÿ
- âœ… CLI å·¥å…·
- âœ… å®Œæ•´æµ‹è¯•

é¡¹ç›®ä»£ç è´¨é‡é«˜ï¼Œæ¶æ„æ¸…æ™°ï¼Œæ˜“äºç»´æŠ¤å’Œæ‰©å±•ã€‚
